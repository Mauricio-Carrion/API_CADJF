# TUNNING BASEADO EM MySQL 5.7 4G/RAM 2/CORE UBT x86_64 = DEDICADO

[client]
port   = 3306
socket = /var/run/mysqld/mysqld.sock 
default-character-set = utf8

# SAFE
[mysqld_safe]
socket = /var/run/mysqld/mysqld.sock
nice   = 0

[mysqld]
default_storage_engine = InnoDB
user     = mysql
pid_file = /var/run/mysqld/mysqld.pid
socket   = /var/run/mysqld/mysqld.sock
                                            
# DIRETORIO DAS DATABASES
basedir = /usr
datadir = /var/lib/mysql
tmpdir  = /tmp          

# BIND
bind-address = 0.0.0.0

# CHARACTER
character-set-server   = utf8
collation-server       = utf8_general_ci
init-connect           = 'SET NAMES utf8'
lower_case-table-names = 1

#TLS
tls_version = TLSV1.1,TLSv1.2, TLSV1.3

# SKIP
skip_external_locking           
skip_name_resolve 
skip-ssl = 1              

# SEGURANCA
max_allowed_packet = 32M
max_connect_errors = 1000000

# ENGINE
#sql_mode=STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION

# LIMITE DE MEMORIA RAM
key_buffer_size            = 128K
sort_buffer_size           = 128K  
join_buffer_size           = 2M
read_buffer_size           = 128K
read_rnd_buffer_size       = 128K	
binlog_cache_size          = 64K
max_join_size              = 2M
thread_stack               = 192K
#myisam_sort_buffer_size   = 200M
#myisam_max_sort_file_size = 256M
#myisam_repair_threads	   = 4
#myisam_recover            = FORCE,BACKUP

# TIMEOUT
connect_timeout     = 100
interactive_timeout = 100
wait_timeout        = 100
lock_wait_timeout   = 100

# LIMITE DE CONEXOES, QUANTO MAIOR O VALOR, MAIS MEMORIA CONSUMIDA
max_connections      = 500
max_user_connections = 500
thread_cache_size    = 100
concurrent_insert    = 2

# INSERT, DELETE, UPDATE, RECOMENDED 4x NUN DISK 
innodb_commit_concurrency = 2

# LIMITE DE PROCESSADOES 2x CORE = InnoDB
innodb_thread_concurrency = 4
###thread_concurrency     = 4

# TABELAS
tmp_table_size           = 1G
max_heap_table_size      = 1G
open_files_limit         = 1024 #65535
table_definition_cache   = 4096 
table_open_cache         = 400  #4000 
###table_cache           = 64
#bulk_insert_buffer_size = 1G

# QUERY E CACHE
query_cache_type  = 1
query_cache_size  = 32M
query_cache_limit = 512K

# QUERY E LOGS
general_log                = 1
general_log_file           = /var/lib/mysql/mysql-general.log
log_error                  = /var/log/mysql/mysql-error.log
long_query_time            = 10
slow_query_log_file        = /var/lib/mysql/mysql-slow.log
innodb_print_all_deadlocks = 1

# MYSQL MASTER
server_id        = 1
#sync_binlog     = 1
log_bin          = /var/log/mysql/mysql-bin.log
expire_logs_days = 10
max_binlog_size  = 100M

# InnoDB IO
innodb_io_capacity      = 200 
innodb_read_io_threads  = 2
innodb_write_io_threads = 2

# LIMITE DE MEMORIA RAM
innodb_flush_method            = O_DIRECT
innodb_log_files_in_group      = 2
innodb_log_file_size           = 4M
innodb_log_buffer_size         = 100M
innodb_flush_log_at_trx_commit = 2
innodb_lock_wait_timeout       = 50
#innodb_table_locks            = 0
innodb_file_per_table          = 1
innodb_buffer_pool_size        = 1G
innodb_buffer_pool_instances   = 2
innodb_data_file_path          = ibdata1:10M:autoextend
#innodb_data_file_path=ibdata1:50M;ibdata2:50M:autoextend:max:500M


### DESCOMENTAR CAUSO UTILISE REPLICACAO.
#server-id = 1 # ID do servidor (1 - Matriz, 2 - Filial).
#auto_increment_increment = 2
#auto-increment-offset    = 1 (1 - Matriz, 2 - Filial).	
#slave-skip-errors = 1030
#log-bin = /var/log/mysql/mysql-bin.log
#
#binlog_do_db = empresa.jfc
#binlog_do_db = empresa.jfe001
#binlog_do_db = empresa.jfee001
#binlog_do_db = empresa.jfi
#########################################

#!includedir /etc/mysql/conf.d/
#!includedir /etc/mysql/mysql.conf.d/
